<!DOCTYPE html>
<html>
  <head>

    <script src="https://aframe.io/releases/1.2.0/aframe.min.js"></script>
    <script src="https://cdn.rawgit.com/jeromeetienne/AR.js/1.5.0/aframe/build/aframe-ar.js"></script>
<script type="importmap">{"imports": {"three": "https://threejs.org/build/three.module.js"}}</script>
<script src="https://binzume.github.io/aframe-vrm/dist/aframe-vrm.js"></script>

<meta charset="UTF-8">

<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300italic,700,700italic">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.1/normalize.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/milligram/1.4.1/milligram.css">

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel="icon" type="image/x-icon" href="image/icon.jpg">

<style>
  input{
    color: white;
  }
</style>

    <title>WEB-AR</title>

  </head>
  <body>

    <a-scene >
  
      <a-entity  vrm-anim="" vrm="src:./model/sample.vrm" rotation="0 180 0" id="vrmarea" scale="1 1 1" position="0 -0.5 -2"></a-entity>

    </a-scene>
    
    <a-marker preset="hiro">
      <!-- マーカーの場所に箱を置く（見やすいようにワイヤーフレーム表示） -->
      <a-box position="0 0.5 0" wireframe="true"></a-box>
    </a-marker>



    <!--ボタン-->
    <button  style="z-index: 100; position: absolute; left: 10px; top: 60px" onclick="onskeleton();">
      skeleton on 
    </button>
    <button  style="z-index: 100; position: absolute; left: 10px; top: 120px" onclick="offskeleton();">
      skeleton off 
    </button>
    <button  style="z-index: 100; position: absolute; left: 10px; top: 180px" onclick="onposer();">
      poser on 
    </button>
    <button  style="z-index: 100; position: absolute; left: 10px; top: 240px" onclick="offposer();">
      poser off 
    </button>
    <script>
      function onskeleton(){
        document.getElementById('vrmarea').setAttribute("vrm-skeleton",``)
  
      }
      function offskeleton(){
        document.getElementById('vrmarea').removeAttribute("vrm-skeleton")
  
      }
      function onposer(){
        document.getElementById('vrmarea').setAttribute("vrm-poser",`enableConstraints:true`)
      }
      function offposer(){
        document.getElementById('vrmarea').removeAttribute("vrm-poser")
      }
    </script>
    <p style="z-index: 100; position: absolute; left: 10px; top: 1px; color: white;">vrmモデルファイルを選択</p>
    <input id="file-sample" type="file" style="z-index: 100; position: absolute; left: 6px; top: 26px" accept=".vrm">

  <script>
    document.getElementById('file-sample').addEventListener('change', function (e) {
      
      // 1枚だけ表示する
      var file = e.target.files[0];
  
      // ファイルのブラウザ上でのURLを取得する
      var blobUrl = window.URL.createObjectURL(file);
  
      
      document.getElementById('vrmarea').setAttribute("vrm",`src:${blobUrl}`)
  
  });
  
  document.getElementById('bvh').addEventListener('change', function (e) {
      
      // 1枚だけ表示する
      var file = e.target.files[0];
  
      // ファイルのブラウザ上でのURLを取得する
      var blobUrl = window.URL.createObjectURL(file);
  
      
      document.getElementById('vrmarea').setAttribute("vrm-anim",`src:${blobUrl}`)
  
  });
  
  document.getElementById('bg').addEventListener('change', function (e) {
      
      // 1枚だけ表示する
      var file = e.target.files[0];
  
      // ファイルのブラウザ上でのURLを取得する
      var blobUrl = window.URL.createObjectURL(file);
  
      
      document.getElementById('body').removeAttribute("style")
      document.getElementById('body').setAttribute("style",`background-image: url(${blobUrl}); background-size: cover; background-repeat: no-repeat;`)
  });
  </script>

  </body>
</html>